<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Energy Predictor</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .prediction-card {
            grid-column: 1 / -1;
        }
        
        .card h2 {
            color: #333;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .form-field {
            display: flex;
            flex-direction: column;
        }
        
        .form-field label {
            font-weight: bold;
            color: #555;
            margin-bottom: 5px;
        }
        
        .form-field input, .form-field select, .form-field textarea {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-field input:focus, .form-field select:focus, .form-field textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .prediction-result {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
            display: none;
        }
        
        .prediction-result.show {
            display: block;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .energy-value {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .scenarios-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
        }
        
        .scenario-item {
            background: #f8f9fa;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .scenario-item:hover {
            background: #e9ecef;
        }
        
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .history-table th, .history-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .history-table th {
            background: #667eea;
            color: white;
        }
        
        .batch-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .error-message {
            background: #dc3545;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: none;
        }
        
        .success-message {
            background: #28a745;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: none;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: #667eea;
            color: white;
            border-radius: 8px 8px 0 0;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .input-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° Manual Energy Predictor</h1>
            <p>Enter environmental conditions to predict energy consumption</p>
        </div>
        
        <!-- Main Prediction Card -->
        <div class="card prediction-card">
            <h2>üéØ Energy Prediction</h2>
            
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="showTab('single')">Single Prediction</button>
                <button class="tab" onclick="showTab('scenarios')">Saved Scenarios</button>
            </div>
            
            <!-- Single Prediction Tab -->
            <div id="single-tab" class="tab-content active">
                <div class="input-group">
                    <div class="form-field">
                        <label for="temperature">üå°Ô∏è Temperature (¬∞C)</label>
                        <input type="number" id="temperature" step="0.1" value="25" min="-50" max="80">
                    </div>
                    
                    <div class="form-field">
                        <label for="humidity">üíß Humidity (%)</label>
                        <input type="number" id="humidity" step="0.1" value="60" min="0" max="100">
                    </div>
                    
                    <div class="form-field">
                        <label for="light">üí° Light Level (%)</label>
                        <input type="number" id="light" step="0.1" value="75" min="0" max="100">
                    </div>
                    
                    <div class="form-field">
                        <label for="motion">üö∂ Motion Detected</label>
                        <select id="motion">
                            <option value="0">No Motion</option>
                            <option value="1">Motion Detected</option>
                        </select>
                    </div>
                </div>
                
                <div class="input-group">
                    <div class="form-field">
                        <label for="userName">üë§ Your Name (Optional)</label>
                        <input type="text" id="userName" placeholder="Enter your name">
                    </div>
                    
                    <div class="form-field">
                        <label for="notes">üìù Notes (Optional)</label>
                        <textarea id="notes" rows="2" placeholder="Add any notes about this prediction..."></textarea>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-primary" onclick="makePrediction()">üîÆ Predict Energy</button>
                    <button class="btn btn-secondary" onclick="savePrediction()">üíæ Save Prediction</button>
                    <button class="btn btn-success" onclick="saveAsScenario()">üìã Save as Scenario</button>
                </div>
                
                <div id="predictionResult" class="prediction-result">
                    <h3>Energy Prediction Result</h3>
                    <div class="energy-value" id="energyValue">0.00 kWh</div>
                    <p id="predictionDetails">Based on your input conditions</p>
                </div>
            </div>
            
            <!-- Batch Prediction Tab -->
            <div id="batch-tab" class="tab-content">
                <div class="batch-section">
                    <h3>üìä Batch Prediction</h3>
                    <p>Enter multiple scenarios for batch prediction</p>
                    
                    <div>
                        <label>Enter scenarios manually (JSON format):</label>
                        <textarea id="batchData" rows="8" placeholder='[
  {"name": "Morning", "temperature": 22, "humidity": 65, "light": 80, "motion": 1},
  {"name": "Evening", "temperature": 26, "humidity": 55, "light": 30, "motion": 1}
]'></textarea>
                        <button class="btn btn-primary" onclick="processBatchManual()">Process Batch</button>
                    </div>
                    
                    <div id="batchResults" style="margin-top: 20px;"></div>
                </div>
            </div>
            
            <!-- Scenarios Tab -->
            <div id="scenarios-tab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3>üìã Saved Scenarios</h3>
                    <button class="btn btn-primary" onclick="loadScenarios()">üîÑ Refresh</button>
                </div>
                
                <div id="scenariosList" class="scenarios-list">
                    <p>No saved scenarios found.</p>
                </div>
            </div>
            
            <div id="errorMessage" class="error-message"></div>
            <div id="successMessage" class="success-message"></div>
        </div>
        
        <!-- Dashboard Grid -->
        <div class="dashboard">
            <!-- Prediction History -->
            <div class="card">
                <h2>üìà Prediction History</h2>
                <button class="btn btn-secondary" onclick="loadHistory()">üîÑ Refresh History</button>
                <div id="historyContainer">
                    <p>No predictions saved yet.</p>
                </div>
            </div>
            
            <!-- Model Information -->
            <div class="card">
                <h2>üß† Model Information</h2>
                <div id="modelInfo">
                    <p><strong>Model Type:</strong> Simulated Energy Prediction Model</p>
                    <p><strong>Algorithm:</strong> Multi-factor regression simulation</p>
                    <p><strong>Accuracy:</strong> ~95% (simulated)</p>
                    <p><strong>Factors:</strong> Temperature, Humidity, Light Level, Motion Detection</p>
                    <p><strong>Last Updated:</strong> June 2025</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentPrediction = null;
        let predictionHistory = [];
        let savedScenarios = [];
        
        // Initialize data from memory
        function initializeData() {
            // Load some sample scenarios
            savedScenarios = [
                {name: "Office Hours", description: "Typical office environment", temperature: 22, humidity: 45, light: 85, motion: 1},
                {name: "Night Mode", description: "Building after hours", temperature: 18, humidity: 50, light: 10, motion: 0},
                {name: "Summer Peak", description: "Hot summer day", temperature: 32, humidity: 70, light: 95, motion: 1}
            ];
        }
        
        // Tab management
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
        
        // Energy prediction algorithm (simulated)
        function calculateEnergy(temp, humidity, light, motion) {
            // Simulate a complex energy prediction algorithm
            let baseEnergy = 2.5; // Base consumption in kWh
            
            // Temperature factor
            if (temp < 18) {
                baseEnergy += (18 - temp) * 0.15; // Heating
            } else if (temp > 24) {
                baseEnergy += (temp - 24) * 0.12; // Cooling
            }
            
            // Humidity factor
            if (humidity > 60) {
                baseEnergy += (humidity - 60) * 0.02; // Dehumidification
            }
            
            // Light factor
            baseEnergy += (light / 100) * 1.2;
            
            // Motion factor
            if (motion === 1) {
                baseEnergy += 0.8; // Additional systems when motion detected
            } else {
                baseEnergy *= 0.7; // Energy saving when no motion
            }
            
            // Add some realistic variation
            baseEnergy += (Math.random() - 0.5) * 0.3;
            
            return Math.max(0.1, parseFloat(baseEnergy.toFixed(2)));
        }
        
        // Single prediction
        function makePrediction() {
            try {
                const temp = parseFloat(document.getElementById('temperature').value);
                const humidity = parseFloat(document.getElementById('humidity').value);
                const light = parseFloat(document.getElementById('light').value);
                const motion = parseInt(document.getElementById('motion').value);
                
                // Validate inputs
                if (isNaN(temp) || isNaN(humidity) || isNaN(light) || isNaN(motion)) {
                    showError('Please enter valid numbers for all fields.');
                    return;
                }
                
                if (temp < -50 || temp > 80) {
                    showError('Temperature must be between -50¬∞C and 80¬∞C');
                    return;
                }
                
                if (humidity < 0 || humidity > 100) {
                    showError('Humidity must be between 0% and 100%');
                    return;
                }
                
                if (light < 0 || light > 100) {
                    showError('Light level must be between 0% and 100%');
                    return;
                }
                
                const predictedEnergy = calculateEnergy(temp, humidity, light, motion);
                
                currentPrediction = {
                    predicted_energy: predictedEnergy,
                    input_data: {
                        temperature: temp,
                        humidity: humidity,
                        light: light,
                        motion: motion
                    },
                    timestamp: new Date().toISOString()
                };
                
                displayPrediction(currentPrediction);
                showSuccess('Prediction completed successfully!');
                
            } catch (error) {
                showError('Error making prediction: ' + error.message);
            }
        }
        
        function displayPrediction(result) {
            document.getElementById('energyValue').textContent = result.predicted_energy + ' kWh';
            document.getElementById('predictionDetails').innerHTML = `
                Temperature: ${result.input_data.temperature}¬∞C | 
                Humidity: ${result.input_data.humidity}% | 
                Light: ${result.input_data.light}% | 
                Motion: ${result.input_data.motion ? 'Yes' : 'No'}
            `;
            
            const resultDiv = document.getElementById('predictionResult');
            resultDiv.classList.add('show');
        }
        
        // Save prediction
        function savePrediction() {
            if (!currentPrediction) {
                showError('No prediction to save. Make a prediction first.');
                return;
            }
            
            try {
                const userName = document.getElementById('userName').value || 'Anonymous';
                const notes = document.getElementById('notes').value || '';
                
                const savedPrediction = {
                    ...currentPrediction,
                    user_name: userName,
                    notes: notes,
                    id: Date.now()
                };
                
                predictionHistory.unshift(savedPrediction);
                
                // Keep only last 20 predictions
                if (predictionHistory.length > 20) {
                    predictionHistory = predictionHistory.slice(0, 20);
                }
                
                showSuccess('Prediction saved successfully!');
                loadHistory();
                
            } catch (error) {
                showError('Error saving prediction: ' + error.message);
            }
        }
        
        // Save as scenario
        function saveAsScenario() {
            const name = prompt('Enter scenario name:');
            if (!name) return;
            
            const description = prompt('Enter scenario description (optional):') || '';
            
            try {
                const scenario = {
                    name: name,
                    description: description,
                    temperature: parseFloat(document.getElementById('temperature').value),
                    humidity: parseFloat(document.getElementById('humidity').value),
                    light: parseFloat(document.getElementById('light').value),
                    motion: parseInt(document.getElementById('motion').value),
                    id: Date.now()
                };
                
                savedScenarios.push(scenario);
                showSuccess('Scenario saved successfully!');
                loadScenarios();
                
            } catch (error) {
                showError('Error saving scenario: ' + error.message);
            }
        }
        
        // Batch prediction
        function processBatchManual() {
            try {
                const batchText = document.getElementById('batchData').value;
                const scenarios = JSON.parse(batchText);
                
                const results = scenarios.map((scenario, index) => {
                    try {
                        const energy = calculateEnergy(
                            scenario.temperature,
                            scenario.humidity,
                            scenario.light,
                            scenario.motion
                        );
                        
                        return {
                            scenario_name: scenario.name || `Scenario ${index + 1}`,
                            scenario_id: index,
                            input_data: {
                                temperature: scenario.temperature,
                                humidity: scenario.humidity,
                                light: scenario.light,
                                motion: scenario.motion
                            },
                            predicted_energy: energy
                        };
                    } catch (err) {
                        return {
                            scenario_id: index,
                            error: `Invalid data: ${err.message}`
                        };
                    }
                });
                
                displayBatchResults(results);
                showSuccess('Batch prediction completed!');
                
            } catch (error) {
                showError('Error processing batch: ' + error.message);
            }
        }
        
        function displayBatchResults(results) {
            const container = document.getElementById('batchResults');
            let html = '<h4>Batch Prediction Results:</h4><table class="history-table">';
            html += '<tr><th>Scenario</th><th>Temperature</th><th>Humidity</th><th>Light</th><th>Motion</th><th>Predicted Energy</th></tr>';
            
            results.forEach(result => {
                if (result.error) {
                    html += `<tr><td colspan="6" style="color: red;">Scenario ${result.scenario_id + 1}: ${result.error}</td></tr>`;
                } else {
                    html += `<tr>
                        <td>${result.scenario_name}</td>
                        <td>${result.input_data.temperature}¬∞C</td>
                        <td>${result.input_data.humidity}%</td>
                        <td>${result.input_data.light}%</td>
                        <td>${result.input_data.motion ? 'Yes' : 'No'}</td>
                        <td><strong>${result.predicted_energy} kWh</strong></td>
                    </tr>`;
                }
            });
            
            html += '</table>';
            container.innerHTML = html;
        }
        
        // Load scenarios
        function loadScenarios() {
            const container = document.getElementById('scenariosList');
            if (savedScenarios.length === 0) {
                container.innerHTML = '<p>No saved scenarios found.</p>';
                return;
            }
            
            let html = '';
            savedScenarios.forEach(scenario => {
                html += `
                    <div class="scenario-item" onclick="loadScenario(${JSON.stringify(scenario).replace(/"/g, '&quot;')})">
                        <strong>${scenario.name}</strong><br>
                        <small>${scenario.description}</small><br>
                        <small>T: ${scenario.temperature}¬∞C, H: ${scenario.humidity}%, L: ${scenario.light}%, M: ${scenario.motion ? 'Yes' : 'No'}</small>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function loadScenario(scenario) {
            document.getElementById('temperature').value = scenario.temperature;
            document.getElementById('humidity').value = scenario.humidity;
            document.getElementById('light').value = scenario.light;
            document.getElementById('motion').value = scenario.motion;
            
            // Switch to single prediction tab
            showTab('single');
            document.querySelector('.tab').click();
            
            showSuccess(`Loaded scenario: ${scenario.name}`);
        }
        
        // Load history
        function loadHistory() {
            const container = document.getElementById('historyContainer');
            
            if (predictionHistory.length === 0) {
                container.innerHTML = '<p>No predictions saved yet.</p>';
                return;
            }
            
            let html = '<table class="history-table">';
            html += '<tr><th>Date</th><th>User</th><th>Energy</th><th>Conditions</th><th>Notes</th></tr>';
            
            predictionHistory.forEach(prediction => {
                const date = new Date(prediction.timestamp).toLocaleString();
                html += `<tr>
                    <td>${date}</td>
                    <td>${prediction.user_name}</td>
                    <td><strong>${prediction.predicted_energy} kWh</strong></td>
                    <td>T:${prediction.input_data.temperature}¬∞C, H:${prediction.input_data.humidity}%, L:${prediction.input_data.light}%, M:${prediction.input_data.motion ? 'Y' : 'N'}</td>
                    <td>${prediction.notes}</td>
                </tr>`;
            });
            
            html += '</table>';
            container.innerHTML = html;
        }
        
        // Utility functions
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }
        
        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 3000);
        }
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeData();
            loadScenarios();
            loadHistory();
        });
    </script>
</body>
</html>